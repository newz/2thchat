<!--{subtemplate common/header}-->
<!-- begin 2th chat -->
<!--{if $chat['guest_show']&&!$_G['uid']}-->
{$chat['guest_show']}
<div style="text-align:right;height:20px;"><span id="n_copyright">&copy; <a href="http://2th.me/" target="_blank">2th Chat</a> <strong>2.13</strong> by <a href="https://www.chaohost.com/client/aff.php?aff=10" target="_blank">ChaoHost</a></span></div>
<!--{else}--> 
<script src="source/plugin/th_chat/js/jquery-3.3.1.min.js" type="text/javascript"></script>
<script src="source/plugin/th_chat/js/jquery.timeago.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="source/plugin/th_chat/template/common.css" />
<script type="text/javascript">
var nzchatobj = jQuery.noConflict();
</script>
<div style="width:100%;margin:0 auto;">
<style type="text/css">
#nzchatcontent{
height:418px;
{$chat['bgcss']}
}
#nzchatolcontent{
height:418px;
}
</style>
<script type="text/javascript">
var nzchatheight = 418;
var nzsid = getcookie('sid', true);
var nztime1 = new Date().getTime();
var nztime2 = 0;
var nztouid=0;
var nzquota=0;
var nzlastid=0;
var nzonol='no';
var nzcolor = '';
var nzcommandz = '';
var formhash = '';
var nzChatPopupContent = '';
function nzolover() {nzonol='yes';}
function nzolout() {nzonol='no';}
function nzalert(text){
	nzchatobj('#nzalertbox').text(text);
	nzchatobj('#nzalertbox').slideDown();
	setTimeout(function(){ nzchatobj('#nzalertbox').slideUp(); }, 3000);
}
nzchatobj(function() {
nzchatobj("#nzchatmessage").keydown(function(event){ if (event.keyCode == '13') {
nzSend();
}
});
<!--{if $chat['autoconnect']==1}-->
nzLoadTextInit();
<!--{/if}-->
});
function nzChatPopup(con){
	nzChatPopupContent = nzchatobj(con).next(".nzchatpopuph").html();
	nzchatobj('#th_chat_popup_box').html(nzChatPopupContent);
	showWindow('th_chat_popup', 'plugin.php?id=th_chat:popup');
}
function nzChatBig(){
if(nzchatheight<830){
nzchatheight+=50;
nzchatobj("#nzchatcontent").animate({height:nzchatheight}, 200 );
nzchatobj("#nzchatolcontent").animate({height:nzchatheight}, 200 );
}
}
function nzChatSmall(){
if(nzchatheight>130){
nzchatheight-=50;
nzchatobj("#nzchatcontent").animate({height:nzchatheight}, 200 );
nzchatobj("#nzchatolcontent").animate({height:nzchatheight}, 200 );
}
}
function nzChatReset(){
nzchatheight=330;
nzchatobj("#nzchatcontent").animate({height:nzchatheight}, 200 );
nzchatobj("#nzchatolcontent").animate({height:nzchatheight}, 200 );
}
function nzSend(){
var data=nzchatobj.trim(nzchatobj("#nzchatmessage").val());
if(data===''){
	return false;
}
nztime1 = new Date().getTime();
if(nztime1>nztime2){
nzchatobj("#nzchatmessage").val('');
nzcolor = nzchatobj('#nzchatskin').val();
nztime2 = nztime1 + {$chat['delay']};
nzchatobj.post("plugin.php?id=th_chat:post"+formhash, {'text':data,'color':nzcolor,'lastid':nzlastid,'touid':nztouid,'quota':nzquota,'command':nzcommandz},function(data) {
if(nzcommandz=='notice'){
nzcommandz='';
nzchatobj('#nznoticecheck').removeAttr('checked');
}else{
nzcommandz='';
nzchatobj('.nzchatrow').each(function() {
if(nzchatobj(this).css("background-color")=='rgb(255, 187, 187)'){
nzchatobj(this).css("background-color", "unset");
}
});
}
if(nzquota>0){
	nzTouid(0);
}
data = JSON.parse(data);
if(data.type==1){
nzalert(data.error);
if(data.script_add==1){
eval(data.script);
}
}else{
var listmess = sortObject(data);
nzchatobj.each(listmess, function(k, v) {
k=parseInt(k);
if(k>nzlastid){
<!--{if $chat['sort']==1}-->
nzlastid=k;
nzchatobj("#afterme").after(v);
<!--{else}-->
nzlastid=k;
nzchatobj("#afterme").before(v);
nzScrollChat();
<!--{/if}-->
}
});
<!--{if $chat['iscleardata']==1}-->
var nzchatrr = nzchatobj(".nzchatrow");
if(nzchatrr.size()>{$chat['chatrowmax']}){
<!--{if $chat['sort']==1}-->
nzchatrr.last().remove();
<!--{else}-->
nzchatrr.first().remove();
<!--{/if}-->
}
<!--{/if}-->
}
});
}else{
nzalert('ส่งข้อความบ่อยไป');
}
return;
}
<!--{if in_array($_G['adminid'],array(1,2,3))}-->
function nzName(i){
var n=prompt("<!--{if $chat['namemode']==1}-->ใส่สถานะใหม่<!--{else}-->ใส่ชื่อใหม่<!--{/if}-->",nzchatobj(".nzu<!--{if $chat['namemode']==1}-->status<!--{else}-->name<!--{/if}-->_"+i).last().html());
if(nzchatobj.trim(n)==''){
return;
}
nzchatobj.post("plugin.php?id=th_chat:name"+formhash, {'new':n},function(data) {
if(data=='ok'){
nzalert('<!--{if $chat['namemode']==1}-->เปลี่ยนสถานะใหม่แล้ว<!--{else}-->เปลี่ยนชื่อใหม่แล้ว<!--{/if}-->');
nzReload();
}else{
nzalert(data);
return;
}
});
}
<!--{/if}-->
function nzCommand(command,xid){
if(command=='')
{
nzalert('คำสั่งผิดพลาด');
}else{
if(command=='del'){var show='ลบข้อความ';var showid = ' ' + nzchatobj("#nzchatcontent"+xid).text();}
else if(command=='edit'){
var nzsamedit = false;
nzchatobj('.nzchatrow').each(function() {
if(nzchatobj(this).css("background-color")=='rgb(255, 187, 187)'){
nzchatobj(this).css("background-color", "unset");
if(nzchatobj("#nzchatmessage").val()==nzchatobj("#nzchatcontent"+xid).text()){nzchatobj("#nzchatmessage").val('');}
if(nzchatobj(this).attr('id')=='nzrows_'+xid){nzcommandz='';nzsamedit = true;return;}
}
});
if(nzcommandz=='notice'){nzchatobj('#nznoticecheck').removeAttr('checked');}
if(!nzsamedit){
nzcommandz='edit '+xid;
nzchatobj('#nzrows_'+xid).css("background-color", "#fbb");
nzchatobj("#nzchatmessage").val(nzchatobj("#nzchatcontent"+xid).text());
nzchatobj("#nzchatmessage").focus();
return;}else{return;}}
else if(command=='ban'){var show='แบน';var showid = ' ' + nzchatobj("#nzolpro_"+xid).text() + '(UID: '+xid+')';}
else if(command=='unban'){var show='ปลดแบน';var showid = ' ' + nzchatobj("#nzolpro_"+xid).text() + '(UID: '+xid+')';}
else if(command=='point'){var show='ให้คะแนน';var n=xid.split("|");var showid = ' ' + n[1] + ' แก่ ' + nzchatobj("#nzolpro_"+n[0]).text() + '(UID: '+xid+')';}
else if(command=='clear'){var show='ล้างห้องแชท';var showid = '';}
else if(command=='name'){
var show='เปลี่ยนชื่อ/สถานะให้กับ';
var person=prompt("<!--{if $chat['namemode']==1}-->ใส่สถานะใหม่<!--{else}-->ใส่ชื่อใหม่<!--{/if}-->",nzchatobj(".nzu<!--{if $chat['namemode']==1}-->status<!--{else}-->name<!--{/if}-->_"+xid).last().html());
if (person!=null && person!="")
{
var showid = ' ' + nzchatobj("#nzolpro_"+i).text() + '(UID: '+xid+')' + ' เป็น '+ person;
var xid = xid + "|:|" + person;
}else{return;}
}
if(confirm('คุณต้องการที่จะ'+show+showid+' ?')==true)
{
nzchatobj("#nzchatmessage").val("!"+command+" "+xid);
nzSend();
}
}
}

function nzLoadTextInit(){
var nzchatskin = window.localStorage.getItem("nzchatskin");
if(nzchatskin!=="default")
{
nzchatobj("#nzchatskin").val(nzchatskin);
nzchatobj("#nzchatskin").css( "background-color","#"+nzchatskin);
nzchatobj("#nzchatskin").css( "color",nzchatobj("#nzchatskin option:selected").css("color"));
}else
{
nzchatobj("#nzchatskin").css( "background-color","");
nzchatobj("#nzchatskin").css( "color","");	
}
nzchatobj.post("plugin.php?id=th_chat:newinit",function(data){
data = JSON.parse(data);
nzlastid=data.lastid;
<!--{if $chat['sort']==1}-->
nzchatobj("#nzchatcontent").html('<table class="nzcallrow"><tr id="afterme" style="height:0px;"><td class="nzavatart"></td><td class="nzcontentt"></td></tr>'+data.datahtml+'</table>');
<!--{else}-->
nzchatobj("#nzchatcontent").html('<table class="nzcallrow">'+data.datahtml+'<tr id="afterme" style="height:0px;"><td class="nzavatart"></td><td class="nzcontentt"></td></tr></table>');
nzScrollChat();
<!--{/if}-->
if(nzonol=='no'){
nzchatobj("#nzchatolcontent").html(data.datachatonline);
}
nzchatobj("#nzoltotal").html(data.chat_online_total);
nzchatobj("#nzchatnotice").html(data.welcometext);
setTimeout(nzLoadText,{$chat['reload']});
});
}
function nzScrollChat(){
var objDiv = document.getElementById("nzchatcontent");
objDiv.scrollTop = objDiv.scrollHeight;
}
function nzLoadText(){
nzchatobj.post("plugin.php?id=th_chat:new", {'lastid':nzlastid},function(data) {
if(data!='not'){
data = JSON.parse(data);
var listmess = sortObject(data.chat_row);
nzchatobj.each(listmess, function(k, v) {
k=parseInt(k);
if(k>nzlastid){
<!--{if $chat['sort']==1}-->
nzlastid=k;
nzchatobj("#afterme").after(v);
<!--{else}-->
nzlastid=k;
nzchatobj("#afterme").before(v);
nzScrollChat();
<!--{/if}-->
}
});
<!--{if $chat['iscleardata']==1}-->
var nzchatrr = nzchatobj(".nzchatrow");
if(nzchatrr.size()>{$chat['chatrowmax']}){
<!--{if $chat['sort']==1}-->
nzchatrr.last().remove();
<!--{else}-->
nzchatrr.first().remove();
<!--{/if}-->
}
<!--{/if}-->
if(data.chat_online){
if(nzonol=='no'){
nzchatobj("#nzchatolcontent").html(data.chat_online);
}
nzchatobj("#nzoltotal").html(data.chat_online_total);
}
}
});
setTimeout(nzLoadText,{$chat['reload']});
}

function nzQuota(i){
<!--{if $chat['quota']==1}-->
nzTouid(0);
nzchatobj("#nztouid").html("<span style='color:#3366CC'>อ้างอิง</span>: "+nzchatobj("#nzchatcontent"+i).html()+" <a href='javascript:void(0);' onClick='nzTouid(0)'>(ยกเลิก)</a>");
nzquota = i;
nzchatobj("#nzchatmessage").focus();
return;
<!--{else}-->
nzchatobj("#nzchatmessage").val(nzchatobj("#nzchatcontent"+i).text()+" // ");
nzchatobj("#nzchatmessage").focus();
return;
<!--{/if}-->
}
function nzAt(i){
seditor_insertunit('nzchat', '@'+i+' ', '');
nzchatobj("#nzchatmessage").focus();
return;
}
function nzTouid(i){
if(i>0){
nzTouid(0);
nzchatobj("#nztouid").html("<span style='color:#3366CC'>กระซิบ:</span> <a href='home.php?mod=space&uid="+i+"' class='nzca' target='_blank'>"+nzchatobj(".nzat_"+i).last()[0].outerHTML+"</a> ["+i+"] <a href='javascript:void(0);' onClick='nzTouid(0)'>(ยกเลิก)</a>");
nztouid = i;
}else{
nzchatobj("#nztouid").html("");
nztouid = 0;
nzquota = 0;
}
}
function nzReload(){
nzchatobj("#nzchatolcontent").html('');
nzchatobj("#nzchatnotice").html('กำลังโหลดประกาศล่าสุด...');
nzchatobj("#nzchatcontent").html('<br /><br /><br /><br /><br /><br /><center><img src="source/plugin/th_chat/images/loading.svg" alt="Load" /></center>');
nzchatobj.post("plugin.php?id=th_chat:newinit",function(data){
data = JSON.parse(data);
nzlastid=data.lastid;
<!--{if $chat['sort']==1}-->
nzchatobj("#nzchatcontent").html('<table class="nzcallrow"><tr id="afterme" style="height:0px;"><td class="nzavatart"></td><td class="nzcontentt"></td></tr>'+data.datahtml+'</table>');
<!--{else}-->
nzchatobj("#nzchatcontent").html('<table class="nzcallrow">'+data.datahtml+'<tr id="afterme" style="height:0px;"><td class="nzavatart"></td><td class="nzcontentt"></td></tr></table>');
nzScrollChat();
<!--{/if}-->
nzchatobj("#nzchatolcontent").html(data.datachatonline);
nzchatobj("#nzchatnotice").html(data.welcometext);
});
}
function nzClean(){
nzchatobj(".nzchatrow").fadeOut('slow');
}
function nzCheckImg(i){
var maxheight=240;
var maxwidth= 500;
var w = parseInt( i.width );
var h = parseInt( i.height );
if ( w > maxwidth )
{
i.style.cursor = "pointer";
i.onclick = function( )
{
var iw = window.open ( this.src, 'ImageViewer','resizable=1' );
iw.focus();
};
h = ( maxwidth / w ) * h;
w = maxwidth;
i.height = h;
i.width = w;
}
if ( h > maxheight )
{
i.style.cursor="pointer";
i.onclick = function( )
{ 
var iw = window.open ( this.src, 'ImageViewer','resizable=1' );
iw.focus();
};
i.width = ( maxheight / h ) * w;
i.height = maxheight;
}
}
function nzPlusone(nz_uid,nz_type){
var nz_res = prompt('เหตุผล');
if(nz_res==null){
nz_res="";
}
nzCommand('point',nz_uid+'|'+nz_type+'|'+nz_res);
}
function sortObject(a) {
var b = {},
c,d = [];
for (c in a) {
if (a.hasOwnProperty(c)) {
d.push(c);
}
}
d.sort();
for (c = 0; c < d.length; c++) {
b[d[c]] = a[d[c]]
}
return b;
}
function nzskincolor() {
	var nzchatskin = nzchatobj("#nzchatskin").val();
	window.localStorage.setItem('nzchatskin',nzchatskin);
	if(nzchatskin!=="default")
	{
	nzchatobj("#nzchatskin").css( "background-color","#"+nzchatskin);
	nzchatobj("#nzchatskin").css( "color",nzchatobj("#nzchatskin option:selected").css("color"));
	}else
	{
	nzchatobj("#nzchatskin").css( "background-color","");
	nzchatobj("#nzchatskin").css( "color","");	
	}
}
</script>
  <div id="nzchat">
    <table id="nzchattable">
      <tr>
        <td><div class="nzchatanno">
          <div id="nzchatnotice" style="float:left;">กำลังโหลดประกาศล่าสุด...</div><div style="float:right;"><!--{if in_array($_G['adminid'],array(1,2,3))}--><input style="position:hidden" type="checkbox" id="nznoticecheck" title="แก้ไข" onChange="if(nzchatobj(this).is(':checked')){nzcommandz='notice';nzchatobj('.nzchatrow').each(function() {if(nzchatobj(this).css('background-color')=='rgb(255, 187, 187)'){nzchatobj(this).css('background-color', 'unset');}});nzchatobj('#nzchatmessage').val(nzchatobj('#nzchatnotice').text());
nzchatobj('#nzchatmessage').focus();}else{if(nzchatobj('#nzchatmessage').val()==nzchatobj('#nzchatnotice').text()){nzchatobj('#nzchatmessage').val('');nzchatobj('#nzchatmessage').focus();}nzcommandz='';}"/> แก้ไข <!--{/if}--><a href="javascript:void(0);" onclick="nzChatBig();">ขยาย</a> <a href="javascript:void(0);" onclick="nzChatSmall();">ย่อ</a> <a href="javascript:void(0);" onclick="nzChatReset();">คืนค่า</a></div></td>
        <td><div class="nzchatanno" style="text-align: center;"> <img src="source/plugin/th_chat/images/message.png" alt=""  align="absmiddle" /> ขณะนี้มีคนออนไลน์ <span id="nzoltotal">N/A</span> คน</div></td>
      </tr>
      <tr>
        <td><div id="nzchatbd">
            <div id="nzchatcontent"><br />
              <br />
              <br />
              <br />
              <br />
              <br />
              <center>
                <!--{if $chat['autoconnect']==1}--><img src="source/plugin/th_chat/images/loading.svg" alt="Load" /><!--{else}-->
              <br />
			  <br />
			  <br />
			  <button type="button" onClick="nzLoadTextInit();" style="
font-size: 14px;
text-align: center;
cursor:pointer;
border: 1px solid transparent;
padding:2px;
width:400px;
border-radius:5px;
color: #ffffff;
background-color: #5bc0de;
border-color: #5bc0de;"><strong> คลิกที่นี่เพื่อเข้าสู่ห้องแชท<!--{/if}--></strong></button>
              </center>
            </div>
          </div></td>
        <td id="nzchatonline"><div id="nzchatolcontent" onMouseOver="nzolover();" onMouseOut="nzolout();"></div></td>
      </tr>
	  <tr>
	  <td colspan="2">
	  <div id="nzalertbox" style="display:none;background:rgba(255, 224, 169, 0.9);width: 100%;height: 30px;margin-top: -30px;position: relative;font-size: 16px;box-sizing: border-box;padding-left: 10px;color: #8a6d3b;line-height: 30px;"></div>
	  <div style="margin-bottom: 2px;"><input name="mtname" type="text" id="nzchatmessage" maxlength="{$chat['chat_strlen']}" placeholder="กรอกข้อความแล้วกดปุ่ม Enter เพื่อส่งข้อความ"/></div>
	  <div style="background:#eaeaea;border: #CCC 1px solid;border-radius:3px;"><table style="width: 100%;">
	  <tr>
        <td style="vertical-align: middle;padding:4px;padding-bottom: 0px;width:100%;">
		<script src="static/js/seditor.js" type="text/javascript"></script>
		<div class="fpd nzchatbbcode">
            {$chat['editor']} <a href="javascript:void(0);" title="โหลดใหม่" onClick="nzReload();" style="background:url(source/plugin/th_chat/images/reload.png) no-repeat center">Reload</a> <a href="plugin.php?id=th_chat:chat_full" title="แชทจอใหญ่" style="background:url(source/plugin/th_chat/images/fullscreen.png) no-repeat center">Zoom</a> 
			<a href="javascript:void(0);" style="background: url(source/plugin/th_chat/images/settings.png) no-repeat 2px 2px;" title="ตั้งค่า" onclick="showWindow('th_chat_setting', 'plugin.php?id=th_chat:setting');return false;">Settings</a>
            <script src="data/cache/common_smilies_var.js?{VERHASH}" type="text/javascript" reload="1"></script> 
            <script type="text/javascript" reload="1">smilies_show('nzchatsmiliesdiv', 9, 'nzchat');</script>
            <select id="nzchatskin" onChange="nzskincolor();">
              <option value="default" style="background-color: #34495e;color: #ffffff;" selected="selected">Skin Default</option>
              <option value="000000" style="background-color: #000000;color: #ffffff;">Black</option>
              <option value="a0522d" style="background-color: #a0522d;color: #ffffff;">Sienna</option>
              <option value="006400" style="background-color: #006400;color: #ffffff;">DarkGreen</option>
              <option value="000080" style="background-color: #000080;color: #ffffff;">Navy</option>
              <option value="4b0082" style="background-color: #4b0082;color: #ffffff;">Indigo</option>
              <option value="2f4f4f" style="background-color: #2f4f4f;color: #ffffff;">DarkSlateGray</option>
              <option value="8b0000" style="background-color: #8b0000;color: #ffffff;">DarkRed</option>
              <option value="ff8c00" style="background-color: #ff8c00;color: #000000;">DarkOrange</option>
              <option value="808000" style="background-color: #808000;color: #ffffff;">Olive</option>
              <option value="008000" style="background-color: #008000;color: #ffffff;">Green</option>
              <option value="008080" style="background-color: #008080;color: #ffffff;">Teal</option>
              <option value="0000ff" style="background-color: #0000ff;color: #ffffff;">Blue</option>
              <option value="ff0000" style="background-color: #ff0000;color: #ffffff;">Red</option>
              <option value="f4a460" style="background-color: #f4a460;color: #000000;">SandyBrown</option>
              <option value="9acd32" style="background-color: #9acd32;color: #000000;">YellowGreen</option>
              <option value="2e8b57" style="background-color: #2e8b57;color: #ffffff;">SeaGreen</option>
              <option value="48d1cc" style="background-color: #48d1cc;color: #000000;">MediumTurquoise</option>
              <option value="4169e1" style="background-color: #4169e1;color: #000000;">RoyalBlue</option>
              <option value="800080" style="background-color: #800080;color: #ffffff;">Purple</option>
              <option value="808080" style="background-color: #808080;color: #000000;">Gray</option>
              <option value="ff00ff" style="background-color: #ff00ff;color: #000000;">Magenta</option>
              <option value="ffa500" style="background-color: #ffa500;color: #000000;">Orange</option>
              <option value="00bfff" style="background-color: #00bfff;color: #000000;">DeepSkyBlue</option>
              <option value="9932cc" style="background-color: #9932cc;color: #ffffff;">DarkOrchid</option>
              <option value="c0c0c0" style="background-color: #c0c0c0;color: #000000;">Silver</option>
              <option value="ffc0cb" style="background-color: #ffc0cb;color: #000000;">Pink</option>
              <option value="98fb98" style="background-color: #98fb98;color: #000000;">PaleGreen</option>
              <option value="dda0dd" style="background-color: #dda0dd;color: #000000;">Plum</option>
            </select>
            <div id="nzchatcpy"><span id="n_copyright">&copy; <a href="http://2th.me/" target="_blank">2th Chat</a> <strong>2.14</strong> by <a href="https://www.chaohost.com/client/aff.php?aff=10" target="_blank">ChaoHost</a></span></div>
          </div></td>
      <tr>
	  <td colspan="2" style="padding-left: 10px;">
	  <span><span id="nztouid"></span></span>
        </td>	
	  </td>
	  </tr>
	  </table></div></td>
	  </tr>
    </table>
  </div>
</div>
<!--{/if}--> 
<!-- end 2th chat --> 
<!--{subtemplate common/footer}-->